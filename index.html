<!DOCTYPE html>

<body bgcolor="#b5ffeb">
  <br>
  <button onclick="retrieve()">Get</button>
  <input class="input" id="url2" type="text" name="link" value="https://pastebin.com/FrJPEEwY">
  <br>
  <pr id="debug">some text</pr>

  <script>
    var counter = document.getElementById("test").innerHTML;

    function retrieve() {
      //TODO: write error message when paste is from a non-pro account
      //do it via request.status = 0
      var url = document.getElementById("url2").value;
      var newUrl;
      var tempText
      const regex = /http(?:s)?:\/\/pastebin.com\/(?:raw\/)?([A-z0-9]*)/;

      if ((m = regex.exec(url)) !== null) {
        newUrl = "https://pastebin.com/raw/" + m[1].toString()
      }
      
      var request = makeHttpObject();
      request.open("GET", newUrl, true);

      request.send(null);
      request.onreadystatechange = function() {

        document.getElementById("debug").innerHTML = request.responseText
        if (request.readyState == 4)
          tempText = request.responseText;
        //document.getElementById("debug").innerHTML = request.responseText.toString();
      };

      //document.getElementById("debug").innerHTML = newUrl;
    }

    function makeHttpObject() {
      try {
        return new XMLHttpRequest();
      } catch (error) {}
      try {
        return new ActiveXObject("Msxml2.XMLHTTP");
      } catch (error) {}
      try {
        return new ActiveXObject("Microsoft.XMLHTTP");
      } catch (error) {}

      throw new Error("Could not create HTTP request object.");
    }
  </script>
</body>
